{% extends "base.html" %}

{% block content %}
<h1>{{ articulo.titulo }}</h1>
<p>{{ articulo.contenido }}</p>
<p><em>Visitas: {{ articulo.visitas }}</em></p>

<hr>
<h2>Comentarios</h2>

{% for comentario in comentarios %}
    <div style="margin-bottom: 1em;">
        <strong>{{ comentario.autor }}</strong> dijo:
        <p>{{ comentario.contenido }}</p>
        {% if user == comentario.autor or user.is_superuser or user.is_staff %}
            <a href="{% url 'comentarios:editar' comentario.pk %}">Editar</a> |
            <a href="{% url 'comentarios:eliminar' comentario.pk %}">Eliminar</a>
        {% endif %}
    </div>
{% empty %}
    <p>No hay comentarios aún. ¡Sé el primero en comentar!</p>
{% endfor %}

<hr>
{% if user.is_authenticated %}
    <h3>Deja tu comentario</h3>
    <form action="{% url 'comentarios:agregar' articulo.pk %}" method="post">
        {% csrf_token %}
        {{ form.as_p }}
        <button type="submit">Comentar</button>
    </form>
{% else %}
    <p>Debes <a href="{% url 'login' %}">iniciar sesión</a> para comentar.</p>
{% endif %}

{% endblock %}
